## 何时不推荐蓝/绿部署

随着蓝/绿部署越来越流行，开发人员和公司不断地将这种方法应用到新的和创新的用例中。然而，有一些常见的用例模式不推荐应用这种方法(即使可能)。

在这些情况下，实施蓝/绿部署会带来太多风险，无论是由于解决方法还是部署过程中的其他“移动部件”。这些复杂性可能会引入额外的故障点，或流程崩溃的机会，这可能会抵消蓝/绿部署带来的任何风险缓解好处。

以下高亮模式可能不适合蓝/绿部署。

#### schema是否变得太复杂而无法与代码更改分离？数据存储的共享是否不可行？

在某些情况下，共享数据存储并不被期望或者可行。schema更改非常复杂以至于无法解耦。当蓝色和绿色环境位于地理上不同区域时，数据位置会给应用带来太多的性能下降。当数据存储位于部署环境边界内，并分别与蓝色和绿色应用紧密耦合时，所有这些情况都需要解决方案，

这需要数据修改能够同步-从蓝色环境到绿色环境，反之亦然。实现此目的的系统和流程通常很复杂，并且受到应用数据一致性要求的限制。这意味着在部署期间，还必须管理同步工作负载的可靠性，可伸缩性和性能，从而增加部署风险。

### 应用需要具有“部署感知”吗？
在蓝/绿部署期间，必须使用特征标志来控制应用的行为。这通常是与无法有效地分离schema和代码更改而相结合的原因。应用代码将在部署期间执行其他或备用子程序，以保持数据同步或执行其他与部署相关的任务。在部署期间，通过使用标志配置，可以启用和关闭这些子程序（视情况而定）。

此做法还会带来额外的风险和复杂性，通常不建议使用蓝/绿部署。蓝/绿部署的目标是实现不可变的基础架构，在部署后不会对应用进行更改，而是完全重新部署。这样，可以确保在生产设置和部署设置中运行相同的代码，从而降低整体风险因素。

### 你的商用现货(COTS)应用是否带有一个预定义的更新/升级过程，该过程对蓝/绿部署并不友好？

许多商业软件供应商为他们已经过测试和验证的应用提供了自己的更新和升级过程。虽然供应商越来越多地采用不可变基础架构和自动部署的原则，但并非所有软件产品都具备这些功能。

围绕供应商推荐的更新和部署实践来实现或模拟蓝/绿部署过程也可能带来不必要的风险，可能会抵消这种方法的好处。